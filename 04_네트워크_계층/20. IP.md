# 인터넷 프로토콜 (IP)

네트워크 계층의 핵심 프로토콜은 단연 **IP(Internet Protocol)**입니다.  
IP에는 **IPv4**와 **IPv6** 두 가지 버전이 있으며, 일반적으로 ‘IP’ 또는 ‘IP 주소’라 하면 **IPv4**를 의미하는 경우가 많습니다.

---

## 📌 IP 주소의 형태

- **IPv4 주소**는 총 **4바이트(32비트)**로 구성됩니다.
- 각 1바이트(8비트)는 **0~255**의 10진수로 표현되고, **점(.)**으로 구분됩니다.
- 각 8비트 단위는 **옥텟(Octet)**이라고 부릅니다.

예시: `192.168.1.1` → `192`, `168`, `1`, `1` → 총 4개의 옥텟

---

## 🛠 IP의 주요 기능

1. **IP 주소 지정**  
   IP 주소를 통해 송수신 대상을 식별하고 지정합니다.

2. **IP 단편화(Fragmentation)**  
   전송하려는 패킷이 **MTU(Maximum Transmission Unit)**보다 클 경우,  
   이를 **MTU 이하의 작은 조각**들로 나눠 전송하는 기능입니다.

> 💡 일반적인 MTU 크기: 1500바이트  
> IP 헤더도 MTU에 포함됩니다.  
> 단편화된 패킷은 수신지에서 다시 재조합됩니다.

---

## 🌐 IPv4

IPv4 패킷은 이더넷 프레임의 **데이터 필드(payload)**에 실립니다.  
아래는 IPv4 패킷의 구조입니다:

![IPv4](https://github.com/user-attachments/assets/eb53c5ff-db8a-4d0c-a452-1d8484f9405b)

### 🔹 핵심 필드 7가지

1. **식별자 (Identification)**  
   - 단편화된 패킷이 어떤 메시지에서 왔는지를 식별하기 위한 번호  
   - 수신지에서 패킷을 재조합할 때 사용됨

2. **플래그 (Flags)**  
   - 3비트 중 1비트는 예약, 1비트는 DF(Don't Fragment), 1비트는 MF(More Fragments)  
   - DF가 1이면 단편화 금지

3. **단편화 오프셋 (Fragment Offset)**  
   - 패킷이 원래 데이터의 어느 위치에 해당하는지 나타냄  
   - 패킷 순서를 재조합하는 데 필요

4. **TTL (Time To Live)**  
   - 패킷이 라우터를 지날 때마다 1씩 감소  
   - TTL이 0이 되면 폐기됨  
   - 무한 루프 방지 목적

   ![TTL](https://github.com/user-attachments/assets/87f14910-d346-4a5e-8207-dfd80eb4f28c)

5. **프로토콜 (Protocol)**  
   - 상위 계층 프로토콜 정보 (예: TCP는 6, UDP는 17)

6. **송신지 IP 주소**

7. **수신지 IP 주소**

---

## 🧭 IPv6

IPv4는 최대 **2³²개 (약 43억 개)**의 주소만 제공 → 주소 부족 문제 발생  
→ 이를 해결하기 위해 **IPv6** 등장

### ✅ 특징

- **주소 크기:** 16바이트 (128비트)
- **표기법:** 콜론(:)으로 구분된 8개의 16진수 그룹  
  예: `2001:0db8:85a3:0000:0000:8a2e:0370:7334`
- **주소 개수:** 2¹²⁸ ≈ 무한에 가까움

### 📦 IPv6 패킷 구조 (기본 헤더)

- IPv6 기본 헤더는 IPv4에 비해 단순하며 **40바이트로 고정**되어 있음

#### 주요 필드 4가지

1. **다음 헤더 (Next Header)**  
   - 상위 계층 프로토콜 정보 (TCP, UDP 등)  
   - 또는 확장 헤더(Extension Header)를 가리킴  
   - 확장 헤더는 기본 헤더와 페이로드 사이에 위치하며,  
     홉옵션, 수신지옵션, 라우팅, 단편화, ESP, AH 등 다양한 기능 지원

2. **홉 제한 (Hop Limit)**  
   - IPv4의 TTL과 동일  
   - 라우터를 지날 때마다 1씩 감소

3. **송신지 IP 주소**

4. **수신지 IP 주소**

> 📝 IPv6도 현재 많은 장비가 지원 중이지만,  
> 아직까지는 **IPv4가 실질적으로 더 많이 사용되고 있습니다.**

---

## 🧾 정리

| 항목 | IPv4 | IPv6 |
|------|------|------|
| 주소 길이 | 32비트 (4바이트) | 128비트 (16바이트) |
| 주소 수 | 약 43억 개 | 사실상 무한 |
| 표현 방식 | 10진수 점(.) 구분 | 16진수 콜론(:) 구분 |
| 단편화 | 식별자, 플래그, 오프셋 사용 | 확장 헤더 사용 |
| TTL 기능 | TTL | 홉 제한(Hop Limit) |
| 상위 계층 식별 | Protocol 필드 | Next Header 필드 |
| 헤더 크기 | 가변 길이 | 고정 40바이트 |

> ⚠️ 특별한 언급이 없는 한, IP 또는 IP 주소는 **IPv4**를 의미합니다.
